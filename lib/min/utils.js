'use strict';var _slicedToArray=(function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err) {_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}})();var _createClass=(function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}})();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else {return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}(function(){var Sand=window.Sand=window.Sand||{};var u=Sand.Utils={};var _power=Math.pow;u.doUntil=function(expectedValue,execute,callback,_status){var result=execute(),status=_status||{'end':false};if(result===expectedValue){status['end']=true;callback&&callback()}else if(!status['end']){requestAnimationFrame(u.doUntil.bind(null,expectedValue,execute,callback,status))}return status};u.addDragEvents=function(target,handlers){function touchToClick(evtHandler){if(!evtHandler)return;return function(e){var eCopy={};eCopy.offsetX=e.offsetX===undefined?e.targetTouches.item(0).clientX:e.offsetX;eCopy.offsetY=e.offsetY===undefined?e.targetTouches.item(0).clientY:e.offsetY;eCopy.preventDefault=e.preventDefault.bind(e);return evtHandler(eCopy)}}var startHandler=touchToClick(handlers['start']);var moveHandler=touchToClick(handlers['move']);var endHandler=touchToClick(handlers['end']);if(startHandler){target.addEventListener('mousedown',startHandler);target.addEventListener('touchstart',startHandler)}if(moveHandler){target.addEventListener('mousemove',moveHandler);target.addEventListener('touchmove',moveHandler)}if(endHandler){target.addEventListener('mouseup',endHandler);target.addEventListener('touchend',endHandler)}};var _pos=new WeakMap;u.Vector=(function(){function _class(){var x=arguments.length<=0||arguments[0]===undefined?0:arguments[0];var y=arguments.length<=1||arguments[1]===undefined?0:arguments[1];_classCallCheck(this,_class);_pos.set(this,new Float64Array([x,y]))}_createClass(_class,[{key:'set',value:function set(newPos){var _Array$from=Array.from(newPos);var _Array$from2=_slicedToArray(_Array$from,2);this.x=_Array$from2[0];this.y=_Array$from2[1];return this}},{key:'scale',value:function scale(multiplier){this.set(this.toArray().map(function(val){return val*multiplier}));return this}},{key:'add',value:function add(){var _toArray=this.toArray();var _toArray2=_slicedToArray(_toArray,2);var x=_toArray2[0];var y=_toArray2[1];for(var _len=arguments.length,vecs=Array(_len),_key=0;_key<_len;_key++){vecs[_key]=arguments[_key]}vecs.forEach(function(vec){x+=vec.x;y+=vec.y});this.set([x,y]);return this}},{key:'dot',value:function dot(vector){return this.x*vector.x+this.y*vector.y}},{key:'rect',value:function rect(vector){var _ref=[].concat(_toConsumableArray(this.toArray()),_toConsumableArray(vector.toArray()));var x1=_ref[0];var y1=_ref[1];var x2=_ref[2];var y2=_ref[3];return [[[x1,x2],[x1,y2]],[[y1,x2],[y1,y2]]]}},{key:'rotate',value:function rotate(angle){var sin=Math.sin(angle);var cos=Math.cos(angle);var _toArray3=this.toArray();var _toArray4=_slicedToArray(_toArray3,2);var x=_toArray4[0];var y=_toArray4[1];this.x=x*cos-y*sin;this.y=x*sin+y*cos;return this}},{key:'get',value:function get(){return _pos.get(this)}},{key:'toArray',value:function toArray(){return [].concat(_toConsumableArray(_pos.get(this)))}},{key:'dup',value:function dup(){return new (Function.prototype.bind.apply(u.Vector,[null].concat(_toConsumableArray(_pos.get(this)))))}},{key:'distanceTo',value:function distanceTo(coordArr){var _toArray5=this.toArray();var _toArray6=_slicedToArray(_toArray5,2);var x1=_toArray6[0];var y1=_toArray6[1];var _Array$from3=Array.from(coordArr);var _Array$from4=_slicedToArray(_Array$from3,2);var x2=_Array$from4[0];var y2=_Array$from4[1];return Math.sqrt(_power(x1-x2,2)+_power(y1-y2,2))}},{key:'x',get:function get(){return _pos.get(this)[0]},set:function set(val){_pos.get(this)[0]=val}},{key:'y',get:function get(){return _pos.get(this)[1]},set:function set(val){_pos.get(this)[1]=val}},{key:'magnitude',get:function get(){return this.distanceTo([0,0])}},{key:'angle',get:function get(){var _Math;return (_Math=Math).atan2.apply(_Math,_toConsumableArray(this.toArray().reverse()))}}]);return _class})();u.Color=(function(){function _class2(h,s,l){var a=arguments.length<=3||arguments[3]===undefined?1:arguments[3];_classCallCheck(this,_class2);if(s<0||s>100)throw new RangeError('saturation must be between 0 and 100');if(l<0||l>100)throw new RangeError('lightness must be between 0 and 100');if(a<0||a>1)throw new RangeError('alpha must be between 0 and 1');this._h=h%360;this._s=s;this._l=l;this._a=a}_createClass(_class2,[{key:'hue',value:function hue(){var val=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(val!==null){this._h=val%360;this._h+=360*(this._h<0);return this}return this._h}},{key:'saturation',value:function saturation(){var val=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(val!==null){if(val<0||val>100)throw new RangeError('saturation must be between 0 and 100');this._s=val;return this}return this._s}},{key:'lightness',value:function lightness(){var val=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(val!==null){if(val<0||val>100)throw new RangeError('lightness must be between 0 and 100');this._l=val;return this}return this._l}},{key:'alpha',value:function alpha(){var val=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(val!==null){if(val<0||val>1)throw new RangeError('alpha must be between 0 and 1');this._a=val;return this}return this._a}},{key:'rotate',value:function rotate(amount){this.hue(this.hue()+amount);return this}},{key:'invert',value:function invert(){var newColor=this.dup();newColor.rotate(180).lightness(100-this._l);return newColor}},{key:'complement',value:function complement(){var newColor=this.dup();newColor.rotate(150).lightness(100-this._l);return newColor}},{key:'mix',value:function mix(){var _Math2,_Math3;for(var _len2=arguments.length,colors=Array(_len2),_key2=0;_key2<_len2;_key2++){colors[_key2]=arguments[_key2]}var cRed=this._red(),cGrn=this._green(),cBlu=this._blue(),cSat=this._s,cLit=this._l,cAlph=this._a;colors.forEach(function(color){cRed+=color._red();cGrn+=color._green();cBlu+=color._blue()});var _map=[cRed,cGrn,cBlu].map(function(cVal){return cVal/(colors.length+1)});var _map2=_slicedToArray(_map,3);cRed=_map2[0];cGrn=_map2[1];cBlu=_map2[2];var max=(_Math2=Math).max.apply(_Math2,[cRed,cGrn,cBlu]);var min=(_Math3=Math).min.apply(_Math3,[cRed,cGrn,cBlu]);var delta=max-min;var cHue;switch(max){case cRed:cHue=(cGrn-cBlu)/delta%6;break;case cGrn:cHue=(cBlu-cRed)/delta+2;break;case cBlu:cHue=(cRed-cGrn)/delta+4;break;default:cHue=0;}cHue*=60;if(cHue<0)cHue+=360;var cValues=[cSat,cLit,cAlph];cValues=cValues.map(function(cVal){return cVal/(colors.length+1)});return new (Function.prototype.bind.apply(u.Color,[null].concat([cHue],_toConsumableArray(cValues))))}},{key:'toRGBA',value:function toRGBA(){return 'rgba('+this.red()+', '+this.green()+', '+this.blue()+', '+this._a+')'}},{key:'red',value:function red(){return ~ ~(this._red()*this.chroma()*255)}},{key:'_red',value:function _red(){var redAmount;if(this._h<=60||this._h>=300){redAmount=1}else if(this._h<120){redAmount=1-(this._h-60)/60}else if(this._h>240){redAmount=(this._h-240)/60}else {redAmount=0}return redAmount}},{key:'green',value:function green(){return this.dup().rotate(-120).red()}},{key:'blue',value:function blue(){return this.dup().rotate(120).red()}},{key:'_green',value:function _green(){return this.dup().rotate(-120)._red()}},{key:'_blue',value:function _blue(){return this.dup().rotate(120)._red()}},{key:'chroma',value:function chroma(){return (this._l>=50?1:this._l/50)*(this._s/50)}},{key:'toString',value:function toString(){return 'hsla('+this._h+', '+this._s+'%, '+this._l+'%, '+this._a+')'}},{key:'dup',value:function dup(){return new u.Color(this._h,this._s,this._l,this._a)}}]);return _class2})()})();